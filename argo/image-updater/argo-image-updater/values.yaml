

deployment:
  nameOverride: argo-image-updater
  fullnameOverride: argo-image-updater
  #registries:
  #  - name: Docker Registry MW Local
  #    prefix: docker-registry.mw.local
  #    api_url: https://docker-registry.mw.local
  #    default: true
  #    insecure: true
  initContainers: 
    - name: add-trusted-ca-certificates
      image: alpine:3.8
      command: [sh, -c]
      securityContext:
        runAsUser: 0
        runAsNonRoot: false
      args: 
        - | 
          apk add --upgrade ca-certificates && \
          update-ca-certificates && cp -r /etc/ssl/certs/* /artifact/
      volumeMounts:
        - mountPath: /usr/local/share/ca-certificates/homelab-root-ca.crt # aparently need to change extension
          subPath: homelab-root-ca.crt
          name: trusted-ca-certificates
          readOnly: true
        - mountPath: /artifact
          name: tmp
          readOnly: false
  volumeMounts:
      - name: tmp
        mountPath: /etc/ssl/certs
        readOnly: false
      - mountPath: /app
        name: ssh-key
        subPath: id_rsa
        readOnly: true
  volumes:
    - name: trusted-ca-certificates
      configMap:
        name: homelab-root-ca-bundle
        items:
          - key: root-certs.pem
            path: homelab-root-ca.crt
    - name: ssh-key
      secret:
        secretName: github-ssh-key
        items: 
          - key: id_rsa
            path: id_rsa
    - name: tmp
      emptyDir: {}
  extraObjects:
    - apiVersion: bitnami.com/v1alpha1
      kind: SealedSecret
      metadata:
        name: github-ssh-key
        namespace: argocd
      spec:
        encryptedData:
          id_rsa: AgAF/PrrtkJoH0jPjPHoN03l6meueg3abPEqM/pgbm4ppfZ5tyobT/oiCL5S7o/VHOgtNnED/FgBMPQoB1/5QyitaPU9JXFVpUD48k6mHq3Ww8pvHO5mj2Oir8XIiKoNDunrvvZqkgkRBxZKMqzQ/Pj6i/rvZKE00LYvq7xE7D5GjJTjJSyQfwewfajcVF+Urbpjht6spFkbVibmDk2ggEOpRw7uT2wiX/qk7bgWlrlkbpe3UeHYcTjsc368L7713mgr2tSkvUyElqiMUFdnqndl1G48OYPlIqxYjDW4hS0ZonNrDZ7Ohfgfz/NubgBiSG+6eJvzQ9S7Evzcl/PjwKnc3Cz/2IMeHc7EOpLIoZSJ6P8VoSnOguO2OyLHxpqG4v7+LFXf89EHKV8CvguZeAtkcKHQQh//M5gW9UFS+ajcPuqcTsEqJp1Bl1vdlxytSOohKYalIlsTxvFNGteZK4vi4VGkiV+e0NxFDnUd1a2LZc+TmMAjMT8EvwZlDW15ltiBypzDq/O38Gd0aG9feDKqTyWz0uM2PVoOYWPn2e7UeZBQZoOIkjLw4KUSRfjgpJdxGF3tq/NaZ1DDlPNQK1Y8wO2IQCR9aoxUTaFizzDoXXNSsNk8Rs2VBQElfWm4S8GAGBMpaWzR0T7sKISzJtbQ7bUwqFuSQpipzF4QsP3KJV/RjAxeN+406qK6KMr1ea83vw5ki8L4LvBPksl8Hv9flK1FdaTwZ00mhzeP2zTsfh42lnYS54q+hUurZp8b+Ja8OGCVTWknhGOQOfYBK1aF7vYNcau7CWon6CiQUnS1+sSBxyu9DG3ZpEdNXUlNY7NJje2ExarAIGOR3aTOEl+NeBrPNbGYQb36bFv6OUwHO5rupha6U/rL6dFXbb8ibbVQbFhtI8xo/aneDzH0WAibhJSA2nyVYDzRX3ZdkpALHQ3HxmGlEMwKfOvgCR55ilczho86y7ndVFg9gqIyiBBdfEwTLaQUEi/ihWNxxepxIvssgO3VAv9AZUHjYSPbRc72xnl4oPVHcYD3O1a0qgEtv4hZDLL7VsxbMeJ3sCFGMv1OiKIwgIAtIAWD91tBGH++YXII+7/4nGzgky0B/kYueFQR7b7EsFeFXK0PdUhUwaqpDKsxNWZIYkQzVLeiRplKb2ipnTJ4uq5hXBUlDN0IWj4SS84ejWwUtE8mgPlG8rnM0vRUZlvV3VR+Ky8EyvEj6wg=
        template:
          metadata:
            name: github-ssh-key
            namespace: argocd
          type: Opaque
